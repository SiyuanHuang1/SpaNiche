% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/spaniche_nmf_celltype_and_lr.R
\name{spaniche_nmf_celltype_and_lr}
\alias{spaniche_nmf_celltype_and_lr}
\title{spaniche_nmf_celltype_and_lr: Joint factorization of cell-type abundance  and ligand-receptor interaction matrices}
\usage{
spaniche_nmf_celltype_and_lr(
  spatial.seu,
  spatialdf,
  spot_by_celltype,
  smoothing_type = c("view0", "view1", "view2"),
  distance_thre = c(NA, 2/(3^0.5), 4/(3^0.5)),
  digits = 2,
  LRDB = SpaNiche::CellChatDB.human,
  LR_dm_type = c("view1", "view2"),
  LR_distance_thre = c(2/(3^0.5), 4/(3^0.5)),
  var_thre = c(0.2, 0.99),
  topic_num = 15,
  defined_weight = "default",
  lambda_v = c(0.5, 1, 2),
  sigma_v = c(0.5, 1, 1.5),
  maxiter = 200,
  st.count = 20,
  epsilon = 1e-04
)
}
\arguments{
\item{spatial.seu}{ST data is processed as a Seurat object with 'Spatial' as the assay name. Seurat object is normalized by using the 'NormalizeData' function. The order of spots must be consistent with spatialdf.}

\item{spatialdf}{a data frame or matrix that contains two columns, "col" and "row". Row names must be
spot barcodes and consistent with \code{spot_by_celltype}.}

\item{spot_by_celltype}{a data frame or matrix representing the abundance of cell types, with spots as rows and cell types as columns. Its row names should be consistent with the row names of 'spatialdf'.}

\item{smoothing_type}{Character vector specifying the spatial smoothing
levels to include. Supported values are:
\itemize{
\item \code{"view0"}: no smoothing (original matrix)
\item \code{"view1"}: first-order spatial neighbors
\item \code{"view2"}: second-order spatial neighbors
}
Valid combinations are \code{c("view0")},
\code{c("view0","view1")}, and
\code{c("view0","view1","view2")}.
As it involves the merging of matrices, the returned matrix's dimension varies depending on the chosen option. The dimensions corresponding to the three options are 1x, 2x, and 3x of the original dimensions, respectively.}

\item{distance_thre}{This parameter represents distance, defining the central distance from center to loop1 (view1), and from center to loop2 (view2). For view0, the distance is ignored and should be set to NA. The length of the vector is consistent with the smoothing_type parameter. For example, A typical choice for Visium data is: distance_thre = c(NA,round(2/(3^0.5),2),round(4/(3^0.5),2)).}

\item{digits}{integer indicating the number of decimal places.}

\item{LRDB}{This parameter represents the reference for cell-cell interactions, which comes from CellChat.}

\item{LR_dm_type}{This parameter can be one or more values from c('view1', 'view2'), representing the type of adjacency matrix to be returned.}

\item{LR_distance_thre}{A numeric vector specifying distance thresholds. If only \code{"view1"} is requested, a single value is sufficient, defining the distance from center to first-order neighbors (view1). If \code{"view1"} + \code{"view2"} is requested, two values are required, defining the distance from center to first-order neighbors (view1) and from center to second-order neighbors (view2).}

\item{var_thre}{Variance threshold}

\item{topic_num}{An integer specifying the number of components or topics to be extracted. It determines the number of columns in the W matrix and the number of rows in each H matrix.}

\item{defined_weight}{Either \code{"default"} to use data-driven modality
weights, or a numeric vector of length two specifying user-defined weights
for the cell-type and LR matrices.}

\item{lambda_v}{Vector of spatial regularization parameters controlling the
strength of Laplacian smoothness.}

\item{sigma_v}{Gaussian kernel parameter. Used in the computation of the Laplacian matrix, influencing how spatial information is incorporated into the factorization.}

\item{maxiter}{The maximum number of iterations allowed for the factorization process. This acts as a stopping criterion to prevent the algorithm from running indefinitely.}

\item{st.count}{Convergence counter. If the change in the reconstruction error remains below epsilon for st.count consecutive iterations, the algorithm stops, assuming it has converged.}

\item{epsilon}{Threshold on the relative change in the objective function used to assess convergence. If the relative change in error is less than epsilon for st.count consecutive iterations, convergence is assumed.}
}
\value{
A list containing:
\itemize{
\item \code{LRintegratedmatrix}: Filtered ligandâ€“receptor interaction matrix.
\item \code{nmf_res}: Results from spatially regularized integrative NMF.
}
}
\description{
spaniche_nmf_celltype_and_lr: Joint factorization of cell-type abundance  and ligand-receptor interaction matrices
}

% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/distribution_2d.R
\name{distribution_2d}
\alias{distribution_2d}
\title{Visualize the 2D spatial distribution of a single feature}
\usage{
distribution_2d(
  feature_matrix,
  one_feature,
  coordinate,
  thre_to_zero,
  color_palette = c("lightgrey", "blue"),
  visualization_type = "point",
  pt.size = 1,
  axis.title.size = 18,
  axis.text.size = 12,
  plot.title.size = 14,
  raster = F
)
}
\arguments{
\item{feature_matrix}{A numeric matrix with features as rows and
samples/spots/cells as columns. Row names must contain \code{one_feature},
and column names must match the \code{SB} column in \code{coordinate}.}

\item{one_feature}{A character string specifying the name of a single feature
(row name of \code{feature_matrix}) to visualize.}

\item{coordinate}{A data frame or matrix containing spatial coordinates.
It must include three columns:
\itemize{
\item \code{SB}: sample/spot/cell identifier
\item \code{row}: y-axis spatial coordinate
\item \code{col}: x-axis spatial coordinate
}}

\item{thre_to_zero}{A numeric value between 0 and 1 indicating the quantile
threshold below which expression values will be set to zero. This can be
used to suppress low-level background noise. Values outside [0, 1) will
result in an error.}

\item{color_palette}{A character vector specifying the color scale.
If a single value is provided, it must be one of \code{"viridis"},
\code{"magma"}, \code{"inferno"}, \code{"plasma"}, or \code{"cividis"}.
If two values are provided, they will be used as the low and high colors
for a continuous gradient.}

\item{visualization_type}{Character string specifying the visualization type.
Either \code{"point"} (default) for raw point visualization or
\code{"density"} for weighted kernel density estimation using the
\pkg{Nebulosa} framework.}

\item{pt.size}{Numeric value controlling the size of points.}

\item{axis.title.size}{Numeric value controlling the font size of axis titles.}

\item{axis.text.size}{Numeric value controlling the font size of axis tick labels.}

\item{plot.title.size}{Numeric value controlling the font size of the plot title.}

\item{raster}{Logical value indicating whether to rasterize the plot using
\pkg{ggrastr}. This is recommended for datasets with a large number of points. By default, it's set to FALSE.}
}
\value{
A \code{ggplot2} object representing the spatial distribution of the
selected feature.
}
\description{
This function visualizes the spatial distribution of a single feature
(e.g., gene expression, topic score, or interaction strength) on a 2D
coordinate system, typically derived from spatial transcriptomics or
imaging-based data. Both point-based and density-based (Nebulosa-style)
visualizations are supported.
}
